---
title: "Migraci칩n de retorno 2020"
author: "Indicadores sociodemogr치ficos"
output:
   html_document:
      highlight: tango
      theme: flatly
      toc: yes
      toc_depth: 2
      toc_float:
        collapsed: yes
---

\usepackage{color}

```{=html}
<style>
code.r{
  font-size: 10px;
}
pre {
  font-size: 12px
}
</style>

<style>
body {
text-align: justify;
font-style: normal;
font-family: "Montserrat Medium";
font-size: 12px
}
h1.title {
  font-size: 40px;
  color: #000D3B;
}
h1 {
  color: #B6854D;
}
h2 {
  color: #172984;
}
h3 {
  color: #172984;
}
</style>
```

```{=html}
<style>
.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #0A2687;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #09C2BC;
}
</style>
```

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = FALSE, cache.lazy = FALSE, 
                         eval = FALSE, class.source = "fold-show")
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
options(digits = 2, encoding = "UTF8")
```   
 

```{r, echo=FALSE}
rm(list = ls())
```

```{r, echo=FALSE}
setwd(here::here())
```


```{r, echo=FALSE}
#Font Stlye
require(showtext)
library(extrafont)
# activar showtext
# SE cargan las funtes del sitema Windows (Pero tarda en correr)
#ttf_import('C:/Users/dvill/AppData/Local/Microsoft/Windows/Fonts/')
#fonts()
#extrafont::loadfonts(device = "win")
#font_import()
windowsFonts()
```


```{r, echo = FALSE}
# Librer칤as que se usaron en el documCVE_ENTo
require(chorddiag)
require(circlize)
require(Cairo)
require(haven)
require(Hmisc) # %nin%
require(dplyr)
require(survey)
require(srvyr)
require(stringr)
require(sna)
require(expss)
require(knitr)
require(kableExtra)
require(sjlabelled)
require(gt)
require(ggplot2)
require(ggpubr)
require(ggalluvial)
require(ggsankey)
require(ggrepel)
require(janitor)
require(tibble)
require(tidyr)
require(reshape2)
require(openxlsx)
require(rlang)
require(doMC)
registerDoMC(cores = 18)
```



**Cuestionario Ampliado del Censo de Poblaci칩n y Vivienda 2020**

El cuestionario ampliado se guarda en un un archivo `.RData`. 

```{r, eval = FALSE}
data <- read_sav("~/Personas_Censo 2020.SAV")
save(data, 
      file = paste0(here::here(),"/Bases/Censo_Personas_2020.RData"))
```

Se seleccionan las variables que se desean conservar para la realizaci칩n de este documento y se guarda en un archivo `.RData` para practicidad del manejo de datos. 

**Posibles variables que se pueden contemplar en la migraci칩n de retorno**     

- `EDAD`, 
- `SEXO`
- `AFRODES`  
- `HLENGUA`   
- `QDIALECT_INALI`
- `PERTE_INDIGENA`  
- `NIVACAD`
- `ALFABET` 
- `CAUSA_MIG`  
- `SITUA_CONYUGAL`  
- `CONACT`  
- `HIJOS_NAC_VIVOS`   

La variable `mydata` contiene **15 015 683 observaciones** y **12 variables**.   

勇뀨 partir de aqu칤 se pueden correr los c칩didos 游녢.
Se carga el archivo `Migracion de retorno_2020.RData`.   

```{r}
load(file = paste0(here::here(), "/Bases/05_Migracion de retorno_2020.RData"))

#Para fines pr치cticos se genera un ponderador de uno 
mydata <- mydata %>%
           mutate(M = 1)  %>%
            mutate(NOM_ENT = as.factor(.$CVE_ENT)) %>%
             ungroup()
```

```{r}
estados <- sjlabelled::get_labels(mydata$CVE_ENT)
nom_estados <- c( "Aguascalientes", "Baja California" ,"Baja California Sur", "Campeche", "Coahuila de Zaragoza", "Colima", 
                  "Chiapas", "Chihuahua", "Ciudad de M칠xico", "Durango", "Guanajuato", "Guerrero", "Hidalgo", "Jalisco",        
                  "M칠xico", "Michoac치n de Ocampo", "Morelos", "Nayarit", "Nuevo Le칩n", "Oaxaca", "Puebla", "Quer칠taro", 
                  "Quintana Roo", "San Luis Potos칤", "Sinaloa", "Sonora", "Tabasco", "Tamaulipas", "Tlaxcala", 
                  "Veracruz de Ignacio de la Llave", "Yucat치n", "Zacatecas")
est <- c("AGS", "BC", "BCS", "CAMP", "COAH", "COL", "CHIS", "CHIH", "CDMX", "DGO", "GTO", "GRO", "HGO",
         "JAL", "MEX", "MICH", "MOR", "NAY", "NL", "OAX", "PUE", "QRO", "QROO", "SLP","SIN","SON", "TAB", 
         "TAMS", "TLX", "VER", "YUC", "ZAC")

# Claves de los estados
ENT <- readRDS(file = paste0(here::here(), "/Bases/estados.RDS"))
```


**Se reclasifican algunas variables**

```{r}
data <- mydata %>%
         mutate(PE = case_when(.$CONACT %in% c("10", "13", "14", "15", "16", "17", "18", "19", "20") & (.$EDAD >= 12 & .$EDAD <= 130) ~ 1,
                               .$CONACT %in% c("30", "40", "50", "60", "70", "80") & (.$EDAD >= 12 & .$EDAD <= 130) ~ 2,
                               .$CONACT %in% c("99") & (.$EDAD >= 12 & .$EDAD <= 130) ~ 99)) %>%
         mutate(PE = labelled(x = .$PE, 
                                  labels = c(`Poblaci칩n economicamente activa` = 1,
                                             `Poblaci칩n no economicamente activa` = 2,
                                             `No especificado` = 99))) %>%
         mutate(ESCOACUM = stringr::str_pad(.$ESCOACUM, width = 2, side = c("left"), pad = "0")) %>%
         mutate(G_ESCOACUM = case_when(.$ESCOACUM %in% c("00", "01", "02", "03", "04") ~ 1,
                                       .$ESCOACUM %in% c("05", "06", "07", "08") ~ 2,
                                       .$ESCOACUM %in% c("09", "10", "11") ~ 3,
                                       .$ESCOACUM %in% c("12", "13","14","15","16", "17", "18","19", "20", "21", "22", "23", "24") ~ 4)) %>%
         mutate(G_ESCOACUM = labelled(x = .$G_ESCOACUM,
                                     labels = c(`0 a 4` = 1,
                                                `5 a 8` = 2,
                                                `9 a 11` = 3,
                                                `12 y m치s` = 4))) %>%
         mutate(ESCOACUM = as.double(.$ESCOACUM)) %>%
         mutate(ESCOACUM = labelled(x = .$ESCOACUM,
                                     labels = c(`00` = 0, 
                                                `01` = 1,
                                                `02` = 2,
                                                `03` = 3,
                                                `04` = 4,
                                                `05` = 5,
                                                `06` = 6,
                                                `07` = 7,
                                                `08` = 8,
                                                `09` = 9,
                                                `10` = 10,
                                                `11` = 11,
                                                `12` = 12,
                                                `13` = 13,
                                                `14` = 14,
                                                `15` = 15,
                                                `16` = 16,
                                                `17` = 17,
                                                `18` = 18,
                                                `19` = 19,
                                                `20` = 20,
                                                `21` = 21,
                                                `22` = 22,
                                                `23` = 23,
                                                `24` = 24,
                                                `99` = 99))) %>%
         mutate(GEDAD = case_when(.$EDAD >= 5 & .$EDAD <= 14 ~ 1,
                                  .$EDAD >= 15 & .$EDAD <= 29 ~ 2,
                                  .$EDAD >= 30 & .$EDAD <= 59 ~ 3,
                                  .$EDAD >= 60 & .$EDAD <= 130 ~ 4)) %>%
          mutate(GEDAD = labelled(x = .$GEDAD, 
                                  labels = c(`5 a 14 a침os` = 1,
                                             `15 a 29 a침os` = 2,
                                             `30 a 59 a침os` = 3, 
                                             `60 a침os y m치s` = 4)))
```


# Nivel estatal {.tabset .tabset-pills}   
 
## Indicadores sociodemogr치ficos {.tabset .tabset-pills}   

### Valores absolutos   

```{r}
#Variable <- "SEXO"
#Variable <- "NIVACAD"
#Clave <- "20.01"
#Clave <- "30.01"

Indicadores <- function(Variable){
                # Filtro de la base de datos
                data <- data %>%
                        filter(I_Migrante_Retorno %in% "Migrante de retorno")
         
                # Municipios
                ## municipios <- MUN %>% pull(CVE_MUN)
                
                # Estados 
                estados <- ENT %>% pull(CVE_ENT)

                # Variable que se dese analizar
                X <- get_values(data[, paste(Variable)], drop.na = TRUE) %>%
                      unlist()
                # Etiquetas para las columnnas
                etiquetas <- get_labels(data[, paste(Variable)], drop.na = TRUE) %>%
                              unlist()

                # Poblaci칩n total
                Pob.Total <- data %>%
                              as.data.frame() %>%
                               filter(CVE_ENT %in% estados) %>%
                                group_by(CVE_ENT) %>%
                                 summarise(Pob.Total = sum(FACTOR, na.rm = TRUE)) %>%
                                  ungroup() %>%
                                   adorn_totals(c("row"), 
                                                fill = "-", 
                                                 na.rm = TRUE) 
                
                #Poblaci칩n desagregada
                 # Filtro de la poblaci칩n desagregada
                p <- sapply(1:length(X), function(x){
                                 Var <- X[x]   
                                  data %>%
                                   as.data.frame() %>%
                                    mutate(EDAD = as.numeric(.$EDAD)) %>%
                                     subset(EDAD >= 5 & EDAD <= 130) %>%
                                      filter(CVE_ENT %in% estados) %>%
                                       filter(ENT_PAIS_RES_5A %in% estados) %>%
                                        filter(get(Variable) %in% Var) %>%
                                         group_by(CVE_ENT) %>%
                                          summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                           set_names(c("CVE_ENT", paste0("Pob_", etiquetas[x])))
                  }, simplify = FALSE
                )
                
                Pob.Objetivo <- left_join(ENT %>% select(CVE_ENT), 
                                          purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                   adorn_totals(c("row"), 
                                                fill = "-", 
                                                 na.rm = TRUE) 

                # Poblaci칩n residente 
                p <- sapply(1:length(X), function(x){
                                 Var <- X[x]     
                                  data %>%
                                   as.data.frame() %>%
                                    mutate(EDAD = as.numeric(.$EDAD)) %>%
                                     subset(EDAD >= 5 & EDAD <= 130) %>%
                                      filter(CVE_ENT == ENT_PAIS_RES_5A) %>%
                                       filter(ENT_PAIS_RES_5A %in% estados) %>%
                                        filter(get(Variable) %in% Var) %>%
                                         group_by(CVE_ENT) %>%
                                          summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                           set_names(c("CVE_ENT", paste0("Residentes_", etiquetas[x])))
                  }, simplify = FALSE
                )

                Residentes <- left_join(ENT %>% select(CVE_ENT),
                                         purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                   adorn_totals(c("row"), 
                                                fill = "-", 
                                                 na.rm = TRUE)
                
                # Poblaci칩n Inmigrante
                p <- sapply(1:length(X), function(x){
                                 Var <- X[x]      
                                  data %>%
                                   as.data.frame() %>%
                                    mutate(EDAD = as.numeric(.$EDAD)) %>%
                                     subset(EDAD >= 5 & EDAD <= 130) %>%
                                      filter(CVE_ENT != ENT_PAIS_RES_5A) %>%
                                       filter(ENT_PAIS_RES_5A %in% estados) %>%
                                        filter(CVE_ENT %in% estados) %>%
                                         filter(get(Variable) %in% Var) %>%
                                          group_by(CVE_ENT) %>%
                                           summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                            set_names(c("CVE_ENT", paste0("Inmigrantes_", etiquetas[x])))
                  }, simplify = FALSE
                )
                
                Inmigrantes <- left_join(ENT %>% select(CVE_ENT),
                                          purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                   adorn_totals(c("row"), 
                                                fill = "-", 
                                                 na.rm = TRUE)
               
                # Poblaci칩n Emigrante
                p <- sapply(1:length(X), function(x){
                                 Var <- X[x]      
                                  data %>%
                                   as.data.frame() %>%
                                    mutate(EDAD = as.numeric(.$EDAD)) %>%
                                     subset(EDAD >= 5 & EDAD <= 130) %>%
                                      filter(CVE_ENT != ENT_PAIS_RES_5A) %>%
                                       filter(ENT_PAIS_RES_5A %in% estados) %>%
                                        filter(ENT_PAIS_RES_5A %in% estados) %>%
                                         filter(get(Variable) %in% Var) %>%
                                          group_by(ENT_PAIS_RES_5A) %>%
                                           summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                            set_names(c("CVE_ENT", paste0("Emigrantes_", etiquetas[x])))
                  }, simplify = FALSE
                )
                
                Emigrantes <- left_join(ENT %>% select(CVE_ENT), 
                                         purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                   adorn_totals(c("row"), 
                                                fill = "-", 
                                                 na.rm = TRUE) 
                
               # Tabla de resultados
                Resultados <- Pob.Total %>%
                               full_join(., Pob.Objetivo, by = c("CVE_ENT")) %>%
                               full_join(., Residentes, by = c("CVE_ENT")) %>%
                               full_join(., Inmigrantes, by = c("CVE_ENT")) %>%
                               full_join(., Emigrantes, by = c("CVE_ENT")) 
                return(Resultados)
}
#tabla <- Indicadores("SEXO")
```


```{r}
require(openxlsx)
wb <- createWorkbook()
addWorksheet(wb, "SEXO")
addWorksheet(wb, "GEDAD")
addWorksheet(wb, "CONACT")
addWorksheet(wb, "PE")
addWorksheet(wb, "AFRODES")
addWorksheet(wb, "HLENGUA")
addWorksheet(wb, "PERTE_INDIGENA")
addWorksheet(wb, "ALFABET")
addWorksheet(wb, "CAUSA_MIG")
addWorksheet(wb, "SITUA_CONYUGAL")
addWorksheet(wb, "NIVACAD")
addWorksheet(wb, "G_ESCOACUM")
writeData(wb, 1, Indicadores("SEXO"), colNames = TRUE)
writeData(wb, 2, Indicadores("GEDAD"), colNames = TRUE)
writeData(wb, 3, Indicadores("CONACT"), colNames = TRUE)
writeData(wb, 4, Indicadores("PE"), colNames = TRUE)
writeData(wb, 5, Indicadores("AFRODES"), colNames = TRUE)
writeData(wb, 6, Indicadores("HLENGUA"), colNames = TRUE)
writeData(wb, 7, Indicadores("PERTE_INDIGENA"), colNames = TRUE)
writeData(wb, 8, Indicadores("ALFABET"), colNames = TRUE)
writeData(wb, 9, Indicadores("CAUSA_MIG"), colNames = TRUE)
writeData(wb, 10, Indicadores("SITUA_CONYUGAL"), colNames = TRUE)
writeData(wb, 11, Indicadores("NIVACAD"), colNames = TRUE)
writeData(wb, 12, Indicadores("G_ESCOACUM"), colNames = TRUE)
saveWorkbook(wb, file = paste0(here::here(), "/Output/Estado/05_Migracion de retorno/2020/SDEM/Indicadores sociodemograficos a nivel estatal 2020.xlsx"), overwrite = TRUE)
```

### Valores relativos  

```{r}
#Variable <- "SEXO"
#Variable <- "NIVACAD"
#Clave <- "20.01"
#Clave <- "30.01"

Indicadores_P <- function(Variable){
                  # Filtro de la base de datos
                  data <- data %>%
                          filter(I_Migrante_Retorno %in% "Migrante de retorno")
                  # Municipios
                  ## municipios <- MUN %>% pull(CVE_MUN)
                  
                  # Estados 
                  estados <- ENT %>% pull(CVE_ENT)
  
                  # Variable que se dese analizar
                  X <- get_values(data[, paste(Variable)], drop.na = TRUE) %>%
                        unlist()
                  # Etiquetas para las columnnas
                  etiquetas <- get_labels(data[, paste(Variable)], drop.na = TRUE) %>%
                                unlist()
  
                  # Poblaci칩n total
                  Pob.Total <- data %>%
                                as.data.frame() %>%
                                 filter(CVE_ENT %in% estados) %>%
                                  group_by(CVE_ENT) %>%
                                   summarise(Pob.Total = sum(FACTOR, na.rm = TRUE)) %>%
                                    ungroup() %>%
                                     adorn_totals(c("row"), 
                                                  fill = "-", 
                                                   na.rm = TRUE) 
                  
                  #Poblaci칩n desagregada
                   # Filtro de la poblaci칩n desagregada
                  p <- sapply(1:length(X), function(x){
                                   Var <- X[x]   
                                    data %>%
                                     as.data.frame() %>%
                                      mutate(EDAD = as.numeric(.$EDAD)) %>%
                                       subset(EDAD >= 5 & EDAD <= 130) %>%
                                        filter(CVE_ENT %in% estados) %>%
                                         filter(ENT_PAIS_RES_5A %in% estados) %>%
                                          filter(get(Variable) %in% Var) %>%
                                           group_by(CVE_ENT) %>%
                                            summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                             set_names(c("CVE_ENT", paste0("Pob_", etiquetas[x])))
                    }, simplify = FALSE
                  )
                  
                  Pob.Objetivo <- left_join(ENT %>% select(CVE_ENT), 
                                            purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                     adorn_totals(c("row"), 
                                                  fill = "-", 
                                                   na.rm = TRUE) %>%
                                     adorn_percentages(denominator = "row") 
  
                  # Poblaci칩n residente 
                  p <- sapply(1:length(X), function(x){
                                   Var <- X[x]     
                                    data %>%
                                     as.data.frame() %>%
                                      mutate(EDAD = as.numeric(.$EDAD)) %>%
                                       subset(EDAD >= 5 & EDAD <= 130) %>%
                                        filter(CVE_ENT == ENT_PAIS_RES_5A) %>%
                                         filter(ENT_PAIS_RES_5A %in% estados) %>%
                                          filter(get(Variable) %in% Var) %>%
                                           group_by(CVE_ENT) %>%
                                            summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                             set_names(c("CVE_ENT", paste0("Residentes_", etiquetas[x])))
                    }, simplify = FALSE
                  )
  
                  Residentes <- left_join(ENT %>% select(CVE_ENT),
                                           purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                     adorn_totals(c("row"), 
                                                  fill = "-", 
                                                   na.rm = TRUE) %>%
                                     adorn_percentages(denominator = "row") 
                  
                  # Poblaci칩n Inmigrante
                  p <- sapply(1:length(X), function(x){
                                   Var <- X[x]      
                                    data %>%
                                     as.data.frame() %>%
                                      mutate(EDAD = as.numeric(.$EDAD)) %>%
                                       subset(EDAD >= 5 & EDAD <= 130) %>%
                                        filter(CVE_ENT != ENT_PAIS_RES_5A) %>%
                                         filter(ENT_PAIS_RES_5A %in% estados) %>%
                                          filter(CVE_ENT %in% estados) %>%
                                           filter(get(Variable) %in% Var) %>%
                                            group_by(CVE_ENT) %>%
                                             summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                              set_names(c("CVE_ENT", paste0("Inmigrantes_", etiquetas[x])))
                    }, simplify = FALSE
                  )
                  
                  Inmigrantes <- left_join(ENT %>% select(CVE_ENT),
                                            purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                     adorn_totals(c("row"), 
                                                  fill = "-", 
                                                   na.rm = TRUE) %>%
                                     adorn_percentages(denominator = "row") 
                 
                  # Poblaci칩n Emigrante
                  p <- sapply(1:length(X), function(x){
                                   Var <- X[x]      
                                    data %>%
                                     as.data.frame() %>%
                                      mutate(EDAD = as.numeric(.$EDAD)) %>%
                                       subset(EDAD >= 5 & EDAD <= 130) %>%
                                        filter(CVE_ENT != ENT_PAIS_RES_5A) %>%
                                         filter(ENT_PAIS_RES_5A %in% estados) %>%
                                          filter(ENT_PAIS_RES_5A %in% estados) %>%
                                           filter(get(Variable) %in% Var) %>%
                                            group_by(ENT_PAIS_RES_5A) %>%
                                             summarise(sum(FACTOR, na.rm = TRUE)) %>%
                                              set_names(c("CVE_ENT", paste0("Emigrantes_", etiquetas[x])))
                    }, simplify = FALSE
                  )
                  
                  Emigrantes <- left_join(ENT %>% select(CVE_ENT), 
                                           purrr::reduce(p, dplyr::full_join, by = 'CVE_ENT'), "CVE_ENT") %>%
                                     adorn_totals(c("row"), 
                                                  fill = "-", 
                                                   na.rm = TRUE) %>%
                                     adorn_percentages(denominator = "row") 
                  
                 # Tabla de resultados
                  Resultados <- Pob.Total %>%
                                 full_join(., Pob.Objetivo, by = c("CVE_ENT")) %>%
                                 full_join(., Residentes, by = c("CVE_ENT")) %>%
                                 full_join(., Inmigrantes, by = c("CVE_ENT")) %>%
                                 full_join(., Emigrantes, by = c("CVE_ENT")) 
                  return(Resultados)
  }
#tabla <- Indicadores_P("SEXO")
```


```{r}
require(openxlsx)
wb <- createWorkbook()
addWorksheet(wb, "SEXO")
addWorksheet(wb, "GEDAD")
addWorksheet(wb, "CONACT")
addWorksheet(wb, "PE")
addWorksheet(wb, "AFRODES")
addWorksheet(wb, "HLENGUA")
addWorksheet(wb, "PERTE_INDIGENA")
addWorksheet(wb, "ALFABET")
addWorksheet(wb, "CAUSA_MIG")
addWorksheet(wb, "SITUA_CONYUGAL")
addWorksheet(wb, "NIVACAD")
addWorksheet(wb, "G_ESCOACUM")
writeData(wb, 1, Indicadores_P("SEXO"), colNames = TRUE)
writeData(wb, 2, Indicadores_P("GEDAD"), colNames = TRUE)
writeData(wb, 3, Indicadores_P("CONACT"), colNames = TRUE)
writeData(wb, 4, Indicadores_P("PE"), colNames = TRUE)
writeData(wb, 5, Indicadores_P("AFRODES"), colNames = TRUE)
writeData(wb, 6, Indicadores_P("HLENGUA"), colNames = TRUE)
writeData(wb, 7, Indicadores_P("PERTE_INDIGENA"), colNames = TRUE)
writeData(wb, 8, Indicadores_P("ALFABET"), colNames = TRUE)
writeData(wb, 9, Indicadores_P("CAUSA_MIG"), colNames = TRUE)
writeData(wb, 10, Indicadores_P("SITUA_CONYUGAL"), colNames = TRUE)
writeData(wb, 11, Indicadores_P("NIVACAD"), colNames = TRUE)
writeData(wb, 12, Indicadores_P("G_ESCOACUM"), colNames = TRUE)
saveWorkbook(wb, file = paste0(here::here(), "/Output/Estado/05_Migracion de retorno/2020/SDEM/Indicadores sociodemograficos a nivel estatal 2020_Porcentajes.xlsx"), overwrite = TRUE)
```


